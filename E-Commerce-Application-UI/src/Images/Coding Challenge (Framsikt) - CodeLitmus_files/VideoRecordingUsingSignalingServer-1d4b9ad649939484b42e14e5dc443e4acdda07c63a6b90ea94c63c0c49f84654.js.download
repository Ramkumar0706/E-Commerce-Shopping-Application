function videoRecordingUsingSignalingServer(e){function n(e){switch(e.event){case"existingParticipants":a(e.userId,e.existingUsers);break;case"receiveVideoAnswer":d(e.senderId,e.sdpAnswer);break;case"candidate":c(e.userId,e.candidate);break;case"turnServer":i(e.turnserver)}}function t(e){g.emit("signaling-message",e)}function i(e){f=e}function r(){let i;t({event:"stopRecordingAndRestart",appName:l}),v.dispose(),g.removeListener("signaling-message",n),videoRecordingUsingSignalingServer(e)}function o(e,n){let i=document.createElement("video"),r=document.createElement("div");r.className="videoContainer",r.id=`participant-video-${e}-${n}`;let o=document.createElement("div");i.id=e,i.autoplay=!0,o.appendChild(document.createTextNode(n)),r.appendChild(i),r.appendChild(o);const a=(e,n,i)=>{let r;t({event:"receiveVideoFrom",userId:c.id,roomName:s,sdpOffer:n})},d=(e,n)=>{var i;t({event:"candidate",userId:c.id,roomName:s,candidate:e})};let c={id:e,userName:n,video:i,rtcPeer:null};u[c.id]=c;let m={remoteVideo:i,onicecandidate:d};f&&(m.configurations={iceServers:f}),c.rtcPeer=kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(m,function(e){if(e)return console.error(e);this.generateOffer(a)})}function a(e,n){let i=document.createElement("video");i.id=e,i.autoplay=!0;let o={id:e,userName:m,video:i,rtcPeer:null},a;u[o.id]=o;const d=(e,n,i)=>{let r;console.log("On Offer"),t({event:"receiveVideoFrom",userId:o.id,roomName:s,sdpOffer:n})},c=(e,n)=>{var i;t({event:"candidate",userId:o.id,roomName:s,candidate:e})};let l={localVideo:i,mediaConstraints:{audio:!0,video:{mandatory:{maxWidth:320,maxFrameRate:15,minFrameRate:5}}},onicecandidate:c};f&&(l.configurations={iceServers:f}),o.rtcPeer=kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(l,function(e){if(e)return console.error(e);this.generateOffer(d)}),v=o.rtcPeer,setTimeout(()=>{r()},3e5)}function d(e,n){const t=u[e];t&&t.rtcPeer.processAnswer(n)}function c(e,n){const t=u[e];t&&t.rtcPeer.addIceCandidate(n)}let s,m,l,u={},v,f=[],g=e.socket,p=document.getElementById("proctoring-data");if(l=p.dataset.appName,s=e.event.toString(),m=e.user.toString(),s&&m){let e;t({event:"joinRoom",roomName:s,userName:m,appName:l,extraInfo:{}})}g.on("signaling-message",n),window.onbeforeunload=function(){v.dispose(),g.disconnect()}}